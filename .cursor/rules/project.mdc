---
description: "Apricode Exchange - –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–µ–∫—Ç–∞"
alwaysApply: true
---

# Apricode Exchange - Project Rules

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

**Apricode Exchange** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (BTC, ETH, USDT, SOL) –∑–∞ —Ñ–∏–∞—Ç–Ω—ã–µ –¥–µ–Ω—å–≥–∏ (EUR, PLN) —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ KYCAID –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π
- –¢–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∫–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (–ø—Ä–æ–¥–∞–∂–∞ - –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–∑–∞—Ö)
- –û–ø–ª–∞—Ç–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ (SEPA/SWIFT)
- –ê–¥–º–∏–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–∫–∞–∑–∞–º–∏ –≤—Ä—É—á–Ω—É—é
- MVP —Ñ–æ–∫—É—Å - –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## üìö Tech Stack

### Frontend
- **Framework:** Next.js 14 (App Router, React Server Components)
- **Language:** TypeScript 5.5+ (strict mode)
- **UI:** shadcn/ui + Radix UI
- **Styling:** Tailwind CSS 3.4
- **State:** React Context + useState (–ø—Ä–æ—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- **Forms:** React Hook Form + Zod validation
- **Icons:** Lucide React

### Backend
- **Runtime:** Node.js 20+ / Next.js API Routes
- **Database:** PostgreSQL 15
- **ORM:** Prisma 5.20
- **Auth:** NextAuth.js v5 (credentials provider)
- **Password:** bcryptjs –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **Validation:** Zod schemas
- **Email:** Resend

### External Services
- **KYC:** KYCAID API
- **Rates:** CoinGecko Free API
- **Hosting:** Vercel
- **Database:** Supabase
- **Storage:** Vercel Blob

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/          # –ì—Ä—É–ø–ø–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ (client)/        # –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ (admin)/         # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ api/             # API routes
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ui/              # shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ forms/           # –§–æ—Ä–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ layouts/         # Layouts
‚îÇ   ‚îî‚îÄ‚îÄ features/        # Feature –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ lib/                 # –£—Ç–∏–ª–∏—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ middleware.ts        # Route protection
```

## üé® –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. TypeScript Strict Mode
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `any` (–∏—Å–ø–æ–ª—å–∑—É–π `unknown` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚úÖ –Ø–≤–Ω—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- ‚úÖ Strict null checks enabled

### 2. Next.js 14 App Router
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Server Components –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ Client Components —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (`'use client'`)
- ‚úÖ Server Actions –¥–ª—è –º—É—Ç–∞—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Layouts –¥–ª—è –æ–±—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ Loading.tsx –∏ Error.tsx –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ —Ä–æ—É—Ç–∞

### 3. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: **PascalCase** (`UserProfile.tsx`)
- –£—Ç–∏–ª–∏—Ç—ã: **camelCase** (`formatCurrency.ts`)
- API routes: **kebab-case** (`exchange-rates/route.ts`)
- Types: **PascalCase** (`OrderTypes.ts`)

### 4. –ò–º–ø–æ—Ä—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É–π –∞–ª–∏–∞—Å—ã: `@/components`, `@/lib`, `@/types`
- –ì—Ä—É–ø–ø–∏—Ä—É–π –∏–º–ø–æ—Ä—Ç—ã: external ‚Üí internal ‚Üí types
- –°–æ—Ä—Ç–∏—Ä—É–π –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø

### 5. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- ‚úÖ JSDoc –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- ‚ùå –ù–ï –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—á–µ–≤–∏–¥–Ω—ã–π –∫–æ–¥
- ‚úÖ TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º: `// TODO: –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è production`

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Critical)

### –í—Å–µ–≥–¥–∞ —Å–æ–±–ª—é–¥–∞—Ç—å:
1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ**
2. **–í–∞–ª–∏–¥–∏—Ä—É–π –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (Zod schemas)
3. **–ü—Ä–æ–≤–µ—Ä—è–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é** –Ω–∞ –∫–∞–∂–¥–æ–º API route
4. **–ò—Å–ø–æ–ª—å–∑—É–π HTTPS** –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
5. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** —á–µ—Ä–µ–∑ bcrypt (–º–∏–Ω–∏–º—É–º 10 rounds)
6. **SQL Injection –∑–∞—â–∏—Ç–∞** - Prisma –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç
7. **XSS –∑–∞—â–∏—Ç–∞** - React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç
8. **CSRF —Ç–æ–∫–µ–Ω—ã** - NextAuth.js –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

## üìù –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
try {
  const result = await someAsyncOperation();
  return { success: true, data: result };
} catch (error) {
  console.error('Context: operation failed', error);
  return { success: false, error: 'User-friendly message' };
}

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
const result = await someAsyncOperation(); // –±–µ–∑ try-catch
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è
```typescript
// ‚úÖ –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π Zod
import { z } from 'zod';

const OrderSchema = z.object({
  amount: z.number().positive(),
  currency: z.enum(['BTC', 'ETH', 'USDT', 'SOL']),
  walletAddress: z.string().min(26).max(62)
});

// –í–∞–ª–∏–¥–∏—Ä—É–π –∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

## üéØ –ü—Ä–∞–≤–∏–ª–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

### KYC Workflow
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è ‚Üí –∞–≤—Ç–æ–ª–æ–≥–∏–Ω
2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è** KYC –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π
3. KYC —Å—Ç–∞—Ç—É—Å—ã: PENDING ‚Üí APPROVED / REJECTED
4. –¢–æ–ª—å–∫–æ APPROVED –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã

### Order Flow
1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí —Å—Ç–∞—Ç—É—Å PENDING
2. –ü–æ–∫–∞–∑ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥
4. –ê–¥–º–∏–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç ‚Üí PROCESSING
5. –ê–¥–º–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∏–ø—Ç—É –≤—Ä—É—á–Ω—É—é ‚Üí COMPLETED

### Fees
- –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: **1.5%**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ–≥–¥–∞ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
- –§–æ—Ä–º—É–ª–∞: `total = amount * rate * (1 + fee)`

## üö´ –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å

- ‚ùå –ù–ï –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (—Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–æ–º)
- ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–¥–∞–∂–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (—Ç–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∫–∞ –≤ MVP)
- ‚ùå –ù–ï –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –∫–∞—Ä—Ç–∞–º–∏ (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã)
- ‚ùå –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–∏–¥–∂–µ—Ç –∏–ª–∏ white-label (Phase 2+)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ CSS –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (—Ç–æ–ª—å–∫–æ Tailwind)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redux/Zustand (–ø—Ä–æ—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `next@^14.2.0`
- `react@^18.3.0`
- `typescript@^5.5.0`
- `@prisma/client@^5.20.0`
- `next-auth@^5.0.0-beta`
- `zod@^3.23.0`

### UI
- `tailwindcss@^3.4.0`
- `lucide-react@^0.400.0`
- Radix UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ shadcn/ui

## üîÑ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **–°–æ–∑–¥–∞–π –≤–µ—Ç–∫—É** –¥–ª—è —Ñ–∏—á–∏
2. **–ù–∞–ø–∏—à–∏ –∫–æ–¥** —Å–ª–µ–¥—É—è —ç—Ç–∏–º –ø—Ä–∞–≤–∏–ª–∞–º
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π** –ª–æ–∫–∞–ª—å–Ω–æ (npm run dev)
4. **–ü—Ä–æ–≤–µ—Ä—å —Ç–∏–ø—ã** (tsc --noEmit)
5. **–ü—Ä–æ–≤–µ—Ä—å lint** (npm run lint)
6. **Commit** —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
7. **Push** –∏ —Å–æ–∑–¥–∞–π PR

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
npm run dev          # –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
npm run build        # Production build
npm run lint         # ESLint –ø—Ä–æ–≤–µ—Ä–∫–∞
npx prisma studio    # UI –¥–ª—è –ë–î
npx prisma migrate   # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```

---

**–ü—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏—è—Ö:** —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –≤ –ø—Ä–æ–µ–∫—Ç–µ, —Å–ª–µ–¥—É–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º.
