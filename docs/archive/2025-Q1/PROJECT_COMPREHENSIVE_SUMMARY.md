   # üìã Apricode Exchange - Comprehensive Project Summary

   **–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 01 –Ω–æ—è–±—Ä—è 2025  
   **–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 2.0 (CRM + Identity & Access Management)  
   **–°—Ç–∞—Ç—É—Å:** ‚úÖ **PRODUCTION READY**

   ---

   ## üéØ Project Overview

   **Apricode Exchange** - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (BTC, ETH, USDT, SOL) –∑–∞ —Ñ–∏–∞—Ç–Ω—ã–µ –¥–µ–Ω—å–≥–∏ (EUR, PLN) —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é CRM-–ø–∞–Ω–µ–ª—å, –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç, comprehensive audit logging, –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –¥–æ—Å—Ç—É–ø–æ–º (IAM).

   ### –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
   - **MVP Feature Complete** - –≤—Å–µ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
   - **Enterprise Security** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - **Compliance Ready** - –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞—É–¥–∏—Ç–∞
   - **Scalable Architecture** - –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
   - **Production Deployed** - –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ Vercel + Supabase

   ---

   ## üèóÔ∏è Technical Architecture

   ### Tech Stack

   **Frontend:**
   - Next.js 14.2 (App Router, React Server Components)
   - TypeScript 5.5+ (strict mode)
   - Tailwind CSS 3.4
   - shadcn/ui + Radix UI (50+ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
   - React Hook Form + Zod validation
   - TanStack Table (v8) –¥–ª—è —Ç–∞–±–ª–∏—Ü
   - Lexical Editor –¥–ª—è rich text
   - SimpleWebAuthn –¥–ª—è Passkeys

   **Backend:**
   - Next.js API Routes (100+ endpoints)
   - PostgreSQL 15 (Supabase)
   - Prisma 5.22 (ORM, 2000+ —Å—Ç—Ä–æ–∫ schema)
   - NextAuth.js v5 (dual auth: Client + Admin)
   - bcryptjs (password hashing, 10 rounds)
   - AES-256-GCM encryption (API keys, sensitive data)

   **External Integrations:**
   - **KYCAID** - KYC verification (forms, documents, webhooks)
   - **CoinGecko** - Exchange rates API
   - **Resend** - Email notifications
   - **Vercel Blob** - File storage (documents, proofs)
   - **Tatum** - Blockchain provider (–≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

   **Infrastructure:**
   - Vercel (hosting, edge functions)
   - Supabase (PostgreSQL database)
   - GitHub (version control, CI/CD)

   ---

   ## üìä Database Schema

   ### Core Models (40+ tables)

   **User Management:**
   - `User` - –∫–ª–∏–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - `Profile` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - `Admin` - –æ—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (IAM)
   - `RoleModel`, `Permission`, `RolePermission` - RBAC —Å–∏—Å—Ç–µ–º–∞
   - `AdminSession` - —Å–µ—Å—Å–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
   - `AdminSettings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–¥–º–∏–Ω–æ–≤

   **KYC & Verification:**
   - `KycSession` - —Å–µ—Å—Å–∏–∏ KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `KycProvider` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã KYC (KYCAID, etc.)
   - `KycProfile` - –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ KYC (PEP, AML, employment)
   - `KycDocument` - –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `KycFormField`, `KycFormData` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—ã
   - `KycLevel`, `UserKycLevel` - —É—Ä–æ–≤–Ω–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `LimitsMatrix` - –ª–∏–º–∏—Ç—ã –ø–æ KYC —É—Ä–æ–≤–Ω—è–º

   **Financial:**
   - `Currency` - –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (BTC, ETH, USDT, SOL + tokens)
   - `FiatCurrency` - —Ñ–∏–∞—Ç–Ω—ã–µ –≤–∞–ª—é—Ç—ã (EUR, PLN)
   - `TradingPair` - —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã
   - `Order` - –∑–∞–∫–∞–∑—ã –Ω–∞ –ø–æ–∫—É–ø–∫—É –∫—Ä–∏–ø—Ç—ã
   - `OrderStatusHistory` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤
   - `PayIn` - –≤—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏ (—Ñ–∏–∞—Ç/–∫—Ä–∏–ø—Ç–∞)
   - `PayOut` - –∏—Å—Ö–æ–¥—è—â–∏–µ –≤—ã–ø–ª–∞—Ç—ã (–∫—Ä–∏–ø—Ç–∞)
   - `PaymentMethod` - –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã
   - `PaymentAccount` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ/–∫—Ä–∏–ø—Ç–æ-–∞–∫–∫–∞—É–Ω—Ç—ã
   - `PaymentProof` - proof of payment –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `PlatformWallet` - –∫–æ—à–µ–ª—å–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - `UserWallet` - –∫–æ—à–µ–ª—å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

   **Rates & Fees:**
   - `RateProvider` - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫—É—Ä—Å–æ–≤ (CoinGecko, Binance, etc.)
   - `RateSnapshot` - –∏—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤
   - `RateHistory` - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
   - `ManualRate` - —Ä—É—á–Ω—ã–µ –∫—É—Ä—Å—ã (overrides)
   - `FeeProfile` - –ø—Ä–æ—Ñ–∏–ª–∏ –∫–æ–º–∏—Å—Å–∏–π

   **Blockchain:**
   - `BlockchainNetwork` - –±–ª–æ–∫—á–µ–π–Ω —Å–µ—Ç–∏ (Bitcoin, Ethereum, Solana, etc.)
   - `CurrencyBlockchainNetwork` - —Å–≤—è–∑–∏ –≤–∞–ª—é—Ç –∏ —Å–µ—Ç–µ–π
   - `Transaction` - –±–ª–æ–∫—á–µ–π–Ω —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

   **Audit & Logging:**
   - `AdminAuditLog` - –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (compliance-ready)
   - `UserAuditLog` - –¥–µ–π—Å—Ç–≤–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
   - `SystemLog` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è (webhooks, API calls)
   - `MfaEvent` - —Å–æ–±—ã—Ç–∏—è MFA –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `AuditLog` - legacy —Ç–∞–±–ª–∏—Ü–∞ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

   **Security & Access:**
   - `WebAuthnCredential` - Passkeys –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
   - `AdminTwoFactorAuth` - TOTP + WebAuthn –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
   - `MfaChallenge` - Step-up MFA challenges
   - `OneTimeAuthToken` - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è Passkey setup
   - `ApiKey`, `ApiKeyUsage` - API –∫–ª—é—á–∏ –¥–ª—è Public API
   - `IPBlacklist` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∞–¥—Ä–µ—Å–æ–≤
   - `SessionRevocation` - –æ—Ç–∑—ã–≤ —Å–µ—Å—Å–∏–π

   **Configuration:**
   - `SystemSettings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
   - `IntegrationSetting` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
   - `PspConnector` - –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
   - `OrderStatusConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤
   - `TransactionStatusConfig` - —Å—Ç–∞—Ç—É—Å—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
   - `WidgetConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤
   - `BankDetails` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
   - `LegalDocument` - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `DocumentTemplate` - —à–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

   **Other:**
   - `EmailLog` - –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ email
   - `DataRetentionPolicy` - –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - `BreakGlassUser` - emergency access –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

   ### Schema Statistics:
   - **2000+ —Å—Ç—Ä–æ–∫** Prisma schema
   - **40+ –º–æ–¥–µ–ª–µ–π** –¥–∞–Ω–Ω—ã—Ö
   - **100+ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - **15+ enum —Ç–∏–ø–æ–≤**
   - **Comprehensive relations** –º–µ–∂–¥—É –≤—Å–µ–º–∏ –º–æ–¥–µ–ª—è–º–∏

   ---

   ## üîê Authentication & Authorization

   ### Dual Authentication System

   **1. Client Authentication (`auth-client.ts`):**
   - NextAuth v5 Credentials Provider
   - Email/Password –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
   - JWT sessions (30 –¥–Ω–µ–π)
   - 2FA support (TOTP)
   - Session revocation
   - Failed login tracking

   **2. Admin Authentication (`auth-admin.ts`):**
   - Separate NextAuth instance –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
   - Email/Password + SSO support
   - **WebAuthn/Passkeys** –¥–ª—è MFA
   - TOTP (Google Authenticator)
   - Step-up MFA –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - Emergency break-glass access

   ### Role-Based Access Control (RBAC)

   **Admin Roles:**
   - `SUPER_ADMIN` - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
   - `ADMIN` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
   - `COMPLIANCE` - compliance officer
   - `TREASURY_APPROVER` - —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç
   - `FINANCE` - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç–¥–µ–ª
   - `SUPPORT` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞
   - `READ_ONLY` - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ

   **Permissions System:**
   - Granular permissions (`Permission` model)
   - Resource-based permissions (`resource.action`)
   - Role-Permission mapping (`RolePermission`)
   - Dynamic permission checking

   **Separation of Duties (SoD):**
   - `canInitiatePayout` / `canApprovePayout` - —Ä–∞–∑–Ω—ã–µ –∞–¥–º–∏–Ω—ã –¥–ª—è –≤—ã–ø–ª–∞—Ç
   - 4-eyes principle –¥–ª—è PayIn/PayOut
   - Step-up MFA required –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

   ### Security Features

   **Password Security:**
   - bcrypt hashing (10 rounds)
   - Password strength requirements
   - Password change tracking
   - Password reset flow

   **Session Management:**
   - JWT tokens (30 days –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
   - Session revocation
   - Idle timeout
   - Device tracking
   - IP-based restrictions

   **Multi-Factor Authentication:**
   - **TOTP** (Time-based One-Time Password)
   - **WebAuthn/Passkeys** (FIDO2)
   - **Backup codes** –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
   - **Step-up MFA** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π (API key revocation, payouts, admin management)

   **API Security:**
   - API key authentication (Public API v1)
   - Rate limiting (100 req/hour per key)
   - API key encryption (AES-256-GCM)
   - Usage tracking
   - IP whitelisting

   ---

   ## üìù Audit & Logging System

   ### Comprehensive Logging Architecture

   **1. AdminAuditLog** - –î–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–æ–≤ —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
   - Compliance fields: `severity`, `isReviewable`, `reviewedAt`
   - MFA verification tracking
   - `diffBefore` / `diffAfter` –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - `freezeChecksum` –¥–ª—è immutability
   - Context: IP, user agent, device, location

   **2. UserAuditLog** - –î–µ–π—Å—Ç–≤–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤:
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (40+ —Ç–∏–ø–æ–≤)
   - Order creation, KYC submission, profile updates
   - Wallet management
   - Security events (password change, 2FA setup)

   **3. SystemLog** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è:
   - Webhook events (KYCAID, payment providers)
   - API calls (CoinGecko, external services)
   - Integration sync events
   - Error logs —Å stack traces
   - Performance metrics (response time)

   **4. MfaEvent** - MFA —Å–æ–±—ã—Ç–∏—è:
   - Step-up MFA challenges
   - Login MFA
   - WebAuthn authentications
   - Failed attempts tracking

   ### Logging Features:

   **Security Audit Service:**
   - Failed login attempts (4 –ø—Ä–∏—á–∏–Ω—ã)
   - Successful logins —Å device info
   - Account lockouts
   - Suspicious activity detection
   - Password changes
   - 2FA setup/disable

   **User Activity Service:**
   - 40+ —Ç–∏–ø–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - Navigation tracking
   - Order lifecycle
   - KYC workflow
   - Profile changes
   - Wallet management

   **System Logging:**
   - Webhook signature verification
   - API call logging (CoinGecko, KYCAID)
   - Integration status
   - Error tracking
   - Performance monitoring

   **Audit UI:**
   - `/admin/audit` - comprehensive audit viewer
   - Filters: date range, severity, action type, admin
   - Statistics dashboard
   - Detailed log view —Å diff visualization
   - Export functionality

   ---

   ## üé® Frontend Architecture

   ### Page Structure (100+ pages)

   **Client Pages (`(client)/`):**
   - `/login`, `/register` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - `/dashboard` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–∞
   - `/buy` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É
   - `/orders` - —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
   - `/orders/[id]` - –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
   - `/kyc` - —Å—Ç–∞—Ç—É—Å KYC
   - `/kyc/form` - —Ñ–æ—Ä–º–∞ KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `/profile` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `/wallets` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞–º–∏

   **Admin Pages (`(admin)/admin/`):**
   - `/admin` - –≥–ª–∞–≤–Ω—ã–π dashboard
   - `/admin/dashboard-v2` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π dashboard
   - `/admin/users` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
   - `/admin/users/[id]` - –¥–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `/admin/orders` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
   - `/admin/orders-kanban` - Kanban board –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
   - `/admin/kyc` - –æ–±–∑–æ—Ä KYC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–π
   - `/admin/audit` - audit logs
   - `/admin/admins` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
   - `/admin/api-keys` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞–º–∏
   - `/admin/integrations` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
   - `/admin/payment-methods` - –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã
   - `/admin/pay-in` - –≤—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏
   - `/admin/pay-out` - –∏—Å—Ö–æ–¥—è—â–∏–µ –≤—ã–ø–ª–∞—Ç—ã
   - `/admin/wallets` - –∫–æ—à–µ–ª—å–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - `/admin/user-wallets` - –∫–æ—à–µ–ª—å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - `/admin/rates` - —Ä—É—á–Ω—ã–µ –∫—É—Ä—Å—ã
   - `/admin/settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
   - `/admin/settings-v2` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - `/admin/profile` - –ø—Ä–æ—Ñ–∏–ª—å –∞–¥–º–∏–Ω–∞
   - `/admin/documents` - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `/admin/documents/editor` - —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

   **Configuration Pages (`/admin/config/`):**
   - `/admin/config/currencies` - –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã
   - `/admin/config/fiat` - —Ñ–∏–∞—Ç–Ω—ã–µ –≤–∞–ª—é—Ç—ã
   - `/admin/pairs` - —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã
   - `/admin/config/fee-profiles` - –ø—Ä–æ—Ñ–∏–ª–∏ –∫–æ–º–∏—Å—Å–∏–π
   - `/admin/config/kyc-levels` - —É—Ä–æ–≤–Ω–∏ KYC
   - `/admin/config/order-statuses` - —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
   - `/admin/config/rate-providers` - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫—É—Ä—Å–æ–≤
   - `/admin/config/psp-connectors` - –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
   - `/admin/config/widgets` - –≤–∏–¥–∂–µ—Ç—ã
   - `/admin/config/banks` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
   - `/admin/blockchains` - –±–ª–æ–∫—á–µ–π–Ω —Å–µ—Ç–∏

   **Admin Auth Pages:**
   - `/admin/auth/login` - –≤—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
   - `/admin/auth/emergency` - emergency access
   - `/admin/auth/setup-passkey` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Passkey

   ### Component Library (100+ components)

   **UI Components (`components/ui/`):**
   - 50+ shadcn/ui components (Button, Dialog, Table, etc.)
   - Form components —Å validation
   - Data visualization (charts, badges)
   - Rich text editor (Lexical)
   - Color picker, QR code generator
   - Phone input, country dropdown

   **Feature Components (`components/features/`):**
   - `KycStatusBadge` - —Å—Ç–∞—Ç—É—Å KYC
   - `OrderStatusBadge` - —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
   - `TwoFactorAuth` - 2FA setup
   - `CurrencyIcon` - –∏–∫–æ–Ω–∫–∏ –≤–∞–ª—é—Ç
   - `ClientOrderWidget` - –≤–∏–¥–∂–µ—Ç –∑–∞–∫–∞–∑–∞
   - `AddWalletDialog` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞

   **Admin Components (`components/admin/`):**
   - `OrderKanban` - Kanban board
   - `OrderDetailsSheet` - –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
   - `OrderTransitionDialog` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
   - `StepUpMfaDialog` - Step-up MFA
   - `PasskeyManagement` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Passkeys
   - `PasskeyLoginButton` - –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Passkey
   - `DataTable` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
   - `PaymentMethodDialog` - –º–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã
   - `BankAccountDialog` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–π –∞–∫–∫–∞—É–Ω—Ç
   - `CryptoWalletDialog` - –∫—Ä–∏–ø—Ç–æ-–∫–æ—à–µ–ª–µ–∫
   - `LegalDocumentEditor` - —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

   **CRM Components (`components/crm/`):**
   - `ResourceManager` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π CRUD –º–µ–Ω–µ–¥–∂–µ—Ä
   - `ResourceFormModal` - –º–æ–¥–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞
   - `ResourceSheet` - –¥–µ—Ç–∞–ª–∏ —Ä–µ—Å—É—Ä—Å–∞
   - `QuickNav` - –±—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
   - `RelatedEntityBadge` - —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

   **Layout Components:**
   - `AdminLayoutClient` - layout –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
   - `AdminSidebar` - –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (25+ —Å—Å—ã–ª–æ–∫)
   - `ClientHeader` / `ClientFooter` - header/footer –∫–ª–∏–µ–Ω—Ç–∞
   - `UserMenu` - –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

   ---

   ## üîå API Endpoints

   ### Authentication API

   **Client Auth:**
   - `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
   - `POST /api/auth/[...nextauth]` - NextAuth endpoints
   - `POST /api/auth/log-login` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞

   **Admin Auth:**
   - `POST /api/admin/auth/[...nextauth]` - NextAuth –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
   - `POST /api/admin/auth/passkey-login` - –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Passkey
   - `GET /api/admin/auth/session` - —Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è
   - `POST /api/admin/auth/check-passkey` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Passkey
   - `GET /api/admin/auth/validate-setup-token` - –≤–∞–ª–∏–¥–∞—Ü–∏—è setup token

   **2FA:**
   - `POST /api/2fa/setup` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ 2FA
   - `POST /api/2fa/verify` - –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è TOTP
   - `GET /api/2fa/status` - —Å—Ç–∞—Ç—É—Å 2FA
   - `POST /api/2fa/backup-codes` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è backup codes
   - `POST /api/2fa/disable` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ 2FA

   **Step-up MFA:**
   - `POST /api/admin/step-up-mfa/challenge` - –∑–∞–ø—Ä–æ—Å challenge
   - `POST /api/admin/step-up-mfa/verify` - –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

   ### KYC API

   - `POST /api/kyc/start` - –Ω–∞—á–∞–ª–æ KYC
   - `GET /api/kyc/status` - —Å—Ç–∞—Ç—É—Å KYC
   - `POST /api/kyc/submit-form` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
   - `POST /api/kyc/upload-document` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - `POST /api/kyc/webhook` - webhook –æ—Ç KYCAID
   - `GET /api/kyc/config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è KYC
   - `GET /api/kyc/form-fields` - –ø–æ–ª—è —Ñ–æ—Ä–º—ã
   - `GET /api/kyc/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

   **Admin KYC:**
   - `GET /api/admin/kyc` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö KYC
   - `GET /api/admin/kyc/[id]` - –¥–µ—Ç–∞–ª–∏ KYC
   - `PATCH /api/admin/kyc/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
   - `POST /api/admin/kyc/create` - —Å–æ–∑–¥–∞–Ω–∏–µ KYC –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `GET /api/admin/kyc/fields` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è–º–∏ —Ñ–æ—Ä–º—ã

   ### Orders API

   **Client:**
   - `POST /api/orders` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - `GET /api/orders` - —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `GET /api/orders/[id]` - –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
   - `POST /api/orders/limit-check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤

   **Admin:**
   - `GET /api/admin/orders` - –≤—Å–µ –∑–∞–∫–∞–∑—ã
   - `PATCH /api/admin/orders/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - `DELETE /api/admin/orders/[id]` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - `POST /api/admin/orders/create-for-client` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

   ### Payments API

   **PayIn:**
   - `GET /api/admin/pay-in` - —Å–ø–∏—Å–æ–∫ PayIn
   - `PATCH /api/admin/pay-in/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ PayIn

   **PayOut:**
   - `GET /api/admin/pay-out` - —Å–ø–∏—Å–æ–∫ PayOut
   - `PATCH /api/admin/pay-out/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ PayOut (—Å Step-up MFA)

   **Payment Methods:**
   - `GET /api/payment-methods` - –ø—É–±–ª–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫
   - `GET /api/admin/payment-methods` - –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫
   - `POST /api/admin/payment-methods` - —Å–æ–∑–¥–∞–Ω–∏–µ
   - `PATCH /api/admin/payment-methods/[code]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

   **Payment Accounts:**
   - `GET /api/admin/payment-accounts` - —Å–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
   - `POST /api/admin/payment-accounts` - —Å–æ–∑–¥–∞–Ω–∏–µ
   - `PATCH /api/admin/payment-accounts/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

   ### Rates API

   - `GET /api/rates` - —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã (–ø—É–±–ª–∏—á–Ω—ã–π)
   - `GET /api/admin/rates` - –≤—Å–µ –∫—É—Ä—Å—ã (–∞–¥–º–∏–Ω)
   - `POST /api/admin/rates/manual` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—É—á–Ω–æ–≥–æ –∫—É—Ä—Å–∞
   - `GET /api/v1/rates` - Public API v1

   ### Admin Management API

   **Admins:**
   - `GET /api/admin/admins` - —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
   - `POST /api/admin/admins` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞
   - `GET /api/admin/admins/[id]` - –¥–µ—Ç–∞–ª–∏ –∞–¥–º–∏–Ω–∞
   - `PATCH /api/admin/admins/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
   - `POST /api/admin/admins/[id]/suspend` - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ (Step-up MFA)
   - `POST /api/admin/admins/[id]/terminate` - —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ (Step-up MFA)
   - `POST /api/admin/admins/invite` - –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞

   **Passkeys:**
   - `POST /api/admin/passkey/challenge` - challenge –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   - `POST /api/admin/passkey/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Passkey
   - `POST /api/admin/passkey/verify` - –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Passkey
   - `GET /api/admin/passkeys` - —Å–ø–∏—Å–æ–∫ Passkeys

   **API Keys:**
   - `GET /api/admin/api-keys` - —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π
   - `POST /api/admin/api-keys` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ (Step-up MFA)
   - `DELETE /api/admin/api-keys/[id]` - –æ—Ç–∑—ã–≤ –∫–ª—é—á–∞ (Step-up MFA)
   - `GET /api/admin/api-keys/[id]/usage` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

   **Sessions:**
   - `GET /api/admin/sessions` - —Å–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π
   - `GET /api/admin/sessions/current` - —Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è
   - `DELETE /api/admin/sessions/[sessionId]` - –æ—Ç–∑—ã–≤ —Å–µ—Å—Å–∏–∏

   ### Configuration API

   **Resources (CRUD –¥–ª—è –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤):**
   - `/api/admin/resources/currencies` - –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã
   - `/api/admin/resources/fiat-currencies` - —Ñ–∏–∞—Ç–Ω—ã–µ –≤–∞–ª—é—Ç—ã
   - `/api/admin/resources/fee-profiles` - –ø—Ä–æ—Ñ–∏–ª–∏ –∫–æ–º–∏—Å—Å–∏–π
   - `/api/admin/resources/kyc-levels` - —É—Ä–æ–≤–Ω–∏ KYC
   - `/api/admin/resources/order-statuses` - —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
   - `/api/admin/resources/rate-providers` - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫—É—Ä—Å–æ–≤
   - `/api/admin/resources/psp-connectors` - PSP –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
   - `/api/admin/resources/widgets` - –≤–∏–¥–∂–µ—Ç—ã
   - `/api/admin/resources/banks` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã

   **Trading Pairs:**
   - `GET /api/admin/trading-pairs` - —Å–ø–∏—Å–æ–∫ –ø–∞—Ä
   - `POST /api/admin/trading-pairs` - —Å–æ–∑–¥–∞–Ω–∏–µ
   - `PATCH /api/admin/trading-pairs/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

   **Blockchains:**
   - `GET /api/admin/blockchains` - —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π
   - `POST /api/admin/blockchains` - —Å–æ–∑–¥–∞–Ω–∏–µ
   - `PATCH /api/admin/blockchains/[code]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

   ### Integrations API

   - `GET /api/admin/integrations` - —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
   - `PATCH /api/admin/integrations/[service]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (Step-up MFA)
   - `GET /api/admin/integrations/coingecko` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CoinGecko

   ### Audit API

   - `GET /api/admin/audit` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ audit logs
   - `GET /api/admin/audit/admin-logs` - –ª–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤
   - `GET /api/admin/audit/user-logs` - –ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - `GET /api/admin/audit/mfa-events` - MFA —Å–æ–±—ã—Ç–∏—è
   - `GET /api/admin/audit/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - `GET /api/admin/audit/[entity]/[entityId]` - –ª–æ–≥–∏ –ø–æ —Å—É—â–Ω–æ—Å—Ç–∏
   - `GET /api/admin/system-logs` - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
   - `GET /api/admin/audit/export` - —ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤

   ### Public API v1

   **Authentication:** API Key (header: `X-API-Key`)

   **Endpoints:**
   - `GET /api/v1/rates` - —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã
   - `GET /api/v1/currencies` - —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç
   - `POST /api/v1/orders` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - `GET /api/v1/orders/[id]` - –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞

   **Features:**
   - Rate limiting (100 req/hour per key)
   - Usage tracking
   - IP whitelisting (optional)
   - Comprehensive error handling

   ### Other APIs

   - `GET /api/users/[id]/activity` - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `GET /api/admin/activity` - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∞–¥–º–∏–Ω–∞
   - `GET /api/admin/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ dashboard
   - `GET /api/settings/public` - –ø—É–±–ª–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - `GET /api/profile` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `PATCH /api/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
   - `POST /api/profile/password` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
   - `GET /api/wallets` - –∫–æ—à–µ–ª—å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `POST /api/wallets` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
   - `POST /api/wallets/validate` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–∞
   - `GET /api/admin/user-wallets` - –≤—Å–µ –∫–æ—à–µ–ª—å–∫–∏
   - `GET /api/admin/documents` - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `POST /api/admin/documents` - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - `GET /api/legal/[slug]` - –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

   ---

   ## üîó External Integrations

   ### KYCAID Integration

   **Features:**
   - Dynamic form configuration
   - Document upload (passport, ID, selfie)
   - Liveness check
   - PEP screening
   - AML checks
   - Webhook signature verification
   - Real-time status updates

   **Configuration:**
   - API key (encrypted in DB)
   - Form ID
   - Webhook secret
   - Base URL
   - Test connection functionality

   **API Endpoints:**
   - Applicant creation
   - Verification creation
   - Document upload
   - Status polling
   - Webhook handling

   ### CoinGecko Integration

   **Features:**
   - Real-time exchange rates
   - Dynamic currency support (–≤—Å–µ –≤–∞–ª—é—Ç—ã –∏–∑ –ë–î)
   - 30-second caching
   - Fallback to cache on API failure
   - Rate aggregation (multiple providers support)
   - Historical rate tracking

   **Supported Currencies:**
   - BTC, ETH, USDT, USDC, SOL, TRX, BNB
   - –ò –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ —á–µ—Ä–µ–∑ `coingeckoId` –≤ –ë–î

   ### Resend Integration

   **Features:**
   - Email notifications –¥–ª—è:
   - Order status changes
   - KYC approval/rejection
   - Password reset
   - 2FA setup
   - Security alerts
   - Template support
   - Email logging

   ### Vercel Blob

   **Features:**
   - Document storage (KYC documents)
   - Payment proof uploads
   - Platform logo storage
   - Secure access control
   - File size limits (10MB)
   - File type validation

   ### Tatum (Ready for Integration)

   **Features:**
   - Blockchain provider –¥–ª—è:
   - Transaction broadcasting
   - Balance checking
   - Address validation
   - Webhook notifications
   - Configuration –≥–æ—Ç–æ–≤–æ –≤ –ë–î

   ---

   ## üõ°Ô∏è Security Implementation

   ### Authentication Security

   **Password Security:**
   - bcrypt hashing (10 rounds)
   - Minimum 8 characters
   - Uppercase, lowercase, number, special character
   - Password history tracking (–≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
   - Account lockout –ø–æ—Å–ª–µ N –ø–æ–ø—ã—Ç–æ–∫

   **Session Security:**
   - JWT tokens —Å expiration
   - Session revocation
   - Idle timeout (15 –º–∏–Ω—É—Ç –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
   - Max session duration (8 —á–∞—Å–æ–≤)
   - Device tracking
   - IP-based restrictions

   **Multi-Factor Authentication:**
   - **TOTP** (Google Authenticator, Authy)
   - **WebAuthn/Passkeys** (FIDO2, hardware keys)
   - **Backup codes** (10 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –∫–æ–¥–æ–≤)
   - **Step-up MFA** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π:
   - API key generation/revocation
   - Payout approval
   - Admin suspend/terminate
   - Integration configuration changes

   ### Authorization Security

   **Role-Based Access Control:**
   - Granular permissions (resource.action)
   - Role-permission mapping
   - Dynamic permission checking
   - Permission inheritance

   **Separation of Duties:**
   - PayIn: `initiatedBy` ‚â† `approvedBy`
   - PayOut: `initiatedBy` ‚â† `approvedBy`
   - Step-up MFA required –¥–ª—è approval
   - 4-eyes principle enforcement

   **API Security:**
   - API key authentication
   - Rate limiting (100 req/hour)
   - API key encryption (AES-256-GCM)
   - Usage tracking
   - IP whitelisting (optional)

   ### Data Protection

   **Encryption:**
   - AES-256-GCM –¥–ª—è sensitive data
   - API keys encrypted at rest
   - Encryption key rotation support

   **Input Validation:**
   - Zod schemas –Ω–∞ –≤—Å–µ—Ö endpoints
   - Type-safe validation
   - SQL injection protection (Prisma)
   - XSS protection (React escaping)

   **Data Access:**
   - Role-based data filtering
   - Audit trail –¥–ª—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - Immutable audit logs (`freezeChecksum`)
   - Data retention policies

   ### Network Security

   **Security Headers:**
   - HSTS (Strict-Transport-Security)
   - X-Frame-Options
   - X-Content-Type-Options
   - X-XSS-Protection
   - Referrer-Policy
   - Content-Security-Policy (–≥–æ—Ç–æ–≤–æ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)

   **Webhook Security:**
   - HMAC signature verification
   - Timestamp validation
   - Request replay protection

   **CSRF Protection:**
   - NextAuth built-in CSRF tokens
   - SameSite cookies
   - Origin validation

   ---

   ## üìà Business Features

   ### Order Management

   **Order Lifecycle:**
   1. `PENDING` - –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω
   2. `PAYMENT_PENDING` - –æ–∂–∏–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   3. `PROCESSING` - –æ–±—Ä–∞–±–æ—Ç–∫–∞
   4. `COMPLETED` - –∑–∞–≤–µ—Ä—à–µ–Ω
   5. `CANCELLED` - –æ—Ç–º–µ–Ω–µ–Ω
   6. `REFUNDED` - –≤–æ–∑–≤—Ä–∞—Ç
   7. `EXPIRED` - –∏—Å—Ç–µ–∫
   8. `FAILED` - –Ω–µ—É–¥–∞—á–Ω—ã–π

   **Features:**
   - Smart status transitions
   - PayIn/PayOut creation –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Transaction hash tracking
   - Admin notes
   - Payment proof upload
   - Kanban board view
   - Drag-and-drop status updates

   ### Payment Processing

   **PayIn (Incoming Payments):**
   - Separation of Duties (SoD)
   - Initiation ‚Üí Approval workflow
   - Amount verification
   - Payment reconciliation
   - Proof attachment
   - Multiple payment methods

   **PayOut (Outgoing Payments):**
   - Step-up MFA required
   - SoD enforcement
   - Platform wallet selection
   - Transaction hash tracking
   - Network fee calculation
   - Confirmation tracking

   ### KYC Verification

   **Workflow:**
   1. User starts KYC
   2. Dynamic form completion
   3. Document upload
   4. Liveness check
   5. KYCAID verification
   6. Admin review
   7. Approval/Rejection

   **Features:**
   - Multiple KYC levels (L0, L1, L2)
   - Limits matrix per level
   - PEP screening
   - AML checks
   - Document verification
   - Resubmission support

   ### Rate Management

   **Dynamic Rate Fetching:**
   - CoinGecko API integration
   - Multiple rate providers support
   - Rate aggregation
   - Manual rate overrides
   - Rate history tracking
   - 30-second caching

   ### Fee Management

   **Fee Profiles:**
   - Standard, VIP profiles
   - Customizable fee percent
   - Fixed fees per currency
   - Network fee policies
   - Spread calculation

   ---

   ## üéØ Admin CRM Features

   ### Dashboard

   **Real-time Statistics:**
   - Total users, orders, volume
   - KYC status breakdown
   - Recent orders feed
   - System health monitoring
   - Auto-refresh (30 seconds)

   **Quick Access:**
   - 8 –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
   - Recent activity
   - Alerts and notifications

   ### Resource Management (CRUD)

   **15 Reference Tables:**
   1. Cryptocurrencies
   2. Fiat Currencies
   3. Trading Pairs
   4. Rate Providers
   5. Fee Profiles
   6. KYC Levels
   7. PSP Connectors
   8. Order Statuses
   9. Transaction Statuses
   10. Widget Configs
   11. Payment Methods
   12. Blockchains
   13. Bank Accounts
   14. Platform Wallets
   15. User Wallets

   **Features:**
   - Modal forms –¥–ª—è create/edit
   - Inline editing
   - Search and filter
   - Sort and pagination
   - Bulk operations
   - Audit logging
   - Related entities display

   ### Integration Management

   **Supported Integrations:**
   - KYCAID (KYC)
   - CoinGecko (Rates)
   - Resend (Email)
   - Tatum (Blockchain - ready)
   - Custom integrations support

   **Features:**
   - Configuration UI
   - Test connection
   - Enable/disable
   - Status monitoring
   - Error logging
   - Last tested timestamp

   ### User Management

   **Client Management:**
   - User list —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
   - User details (profile, orders, activity, KYC)
   - Block/unblock users
   - Activity history
   - KYC status management

   **Admin Management:**
   - Admin list
   - Role assignment
   - Permission management
   - Invite new admins
   - Suspend/terminate (Step-up MFA)
   - Session management

   ### Audit & Compliance

   **Audit Viewer:**
   - 4 –≤–∫–ª–∞–¥–∫–∏: Admin Logs, User Logs, Critical Actions, System Logs
   - Filters: date range, severity, action, admin
   - Statistics dashboard
   - Detailed log view
   - Diff visualization
   - Export functionality

   **Compliance Features:**
   - Immutable audit logs
   - Freeze checksum –¥–ª—è integrity
   - Review workflow
   - Severity levels (INFO, WARNING, CRITICAL)
   - MFA verification tracking

   ---

   ## üì± Client Features

   ### User Dashboard

   **Statistics:**
   - Total orders
   - Total spent
   - KYC status
   - Recent orders

   **Quick Actions:**
   - Create new order
   - View KYC status
   - Manage wallets
   - Update profile

   ### Order Creation

   **Buy Crypto Flow:**
   1. Select cryptocurrency
   2. Select fiat currency
   3. Enter amount (with min/max validation)
   4. Select blockchain network
   5. Enter wallet address (with validation)
   6. Select payment method
   7. Review order (rate, fee, total)
   8. Create order
   9. View bank details
   10. Upload payment proof

   **Features:**
   - Real-time rate preview
   - Fee calculation
   - Wallet address validation
   - Amount limits enforcement
   - KYC requirement check

   ### Order Management

   **Order List:**
   - All user orders
   - Status filtering
   - Date sorting
   - Payment reference search

   **Order Details:**
   - Full order information
   - Bank details
   - Payment instructions
   - Transaction hash (when completed)
   - Status history
   - Admin notes

   ### KYC Verification

   **KYC Form:**
   - Dynamic form fields
   - Step-by-step completion
   - Document upload
   - Liveness check
   - Progress tracking
   - Resubmission support

   **Status Tracking:**
   - Real-time status updates
   - Rejection reasons
   - Admin notes

   ### Profile Management

   **User Profile:**
   - Personal information
   - Contact details
   - Address
   - KYC status
   - 2FA settings
   - Wallet management

   ### Wallet Management

   **User Wallets:**
   - Add wallet (multiple currencies)
   - Verify wallet address
   - Set default wallet
   - Delete wallet
   - Wallet validation

   ---

   ## üöÄ Deployment & Infrastructure

   ### Deployment

   **Vercel:**
   - Automatic deployments from `main` branch
   - Edge functions support
   - Environment variables
   - Build optimization
   - CDN distribution

   **Database (Supabase):**
   - PostgreSQL 15
   - Connection pooling
   - Direct connection –¥–ª—è migrations
   - Automatic backups
   - Point-in-time recovery

   ### Environment Variables

   **Required:**
   - `DATABASE_URL` - PostgreSQL connection
   - `DIRECT_URL` - Direct connection –¥–ª—è migrations
   - `NEXTAUTH_SECRET` - JWT secret (min 32 chars)
   - `NEXTAUTH_URL` - Platform URL

   **Optional:**
   - `KYCAID_API_KEY` - KYCAID integration
   - `KYCAID_FORM_ID` - KYCAID form ID
   - `KYCAID_WEBHOOK_SECRET` - Webhook secret
   - `COINGECKO_API_KEY` - CoinGecko API key (optional)
   - `RESEND_API_KEY` - Email service
   - `EMAIL_FROM` - From email address
   - `BLOB_READ_WRITE_TOKEN` - Vercel Blob
   - `ENCRYPTION_SECRET` - AES encryption key (defaults to NEXTAUTH_SECRET)
   - `TATUM_API_KEY` - Tatum blockchain provider

   ### CI/CD

   **GitHub:**
   - Commit author check
   - Branch protection
   - Automated tests (–≥–æ—Ç–æ–≤–æ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)

   **Vercel:**
   - Auto-deploy from `main`
   - Preview deployments from PRs
   - Environment-specific configs

   ### Monitoring

   **Ready for:**
   - Error tracking (Sentry)
   - Performance monitoring (Vercel Analytics)
   - Uptime monitoring
   - Log aggregation

   ---

   ## üìä Project Statistics

   ### Codebase

   - **2000+ —Å—Ç—Ä–æ–∫** Prisma schema
   - **100+ API endpoints**
   - **100+ React components**
   - **50+ —Å—Ç—Ä–∞–Ω–∏—Ü**
   - **30+ —Å–µ—Ä–≤–∏—Å–æ–≤**
   - **TypeScript strict mode** ‚úÖ
   - **0 linting errors** ‚úÖ

   ### Database

   - **40+ –º–æ–¥–µ–ª–µ–π** –¥–∞–Ω–Ω—ã—Ö
   - **100+ –∏–Ω–¥–µ–∫—Å–æ–≤**
   - **15+ enum —Ç–∏–ø–æ–≤**
   - **Comprehensive relations**

   ### Features

   - **15+ CRM —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤** (–ø–æ–ª–Ω—ã–π CRUD)
   - **40+ —Ç–∏–ø–æ–≤** user actions logging
   - **4 —Ç–∏–ø–∞** audit logs
   - **7 admin roles**
   - **Granular permissions** system
   - **3 MFA methods** (TOTP, WebAuthn, Backup codes)
   - **Step-up MFA** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

   ---

   ## ‚úÖ Completed Features Checklist

   ### Core MVP
   - [x] User registration & authentication
   - [x] KYC verification (KYCAID)
   - [x] Crypto purchase flow
   - [x] Order management
   - [x] Admin panel
   - [x] Email notifications
   - [x] Real-time exchange rates

   ### Security
   - [x] Password hashing (bcrypt)
   - [x] JWT sessions
   - [x] 2FA (TOTP)
   - [x] WebAuthn/Passkeys
   - [x] Step-up MFA
   - [x] API key authentication
   - [x] Rate limiting
   - [x] CSRF protection
   - [x] XSS protection
   - [x] SQL injection protection
   - [x] Input validation (Zod)

   ### CRM Features
   - [x] Full CRUD –¥–ª—è –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
   - [x] Resource management UI
   - [x] Integration management
   - [x] User management
   - [x] Admin management
   - [x] Role & permission system
   - [x] Audit logging
   - [x] Statistics dashboard

   ### Advanced Features
   - [x] Kanban board –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
   - [x] Comprehensive audit logging
   - [x] Document upload (Vercel Blob)
   - [x] Public API v1
   - [x] Dynamic KYC forms
   - [x] Payment accounts management
   - [x] Platform wallets
   - [x] Manual rate overrides
   - [x] Legal documents editor
   - [x] Session management
   - [x] IP blacklisting

   ### Identity & Access Management
   - [x] Separate Admin model
   - [x] RBAC system
   - [x] Permission system
   - [x] WebAuthn/Passkeys
   - [x] Step-up MFA
   - [x] Separation of Duties (SoD)
   - [x] Emergency break-glass access
   - [x] Session revocation
   - [x] Admin activity tracking

   ---

   ## üöß Future Enhancements (Phase 2+)

   ### Planned Features

   1. **Crypto Selling**
      - Client sends crypto ‚Üí receives fiat
      - PayIn crypto, PayOut fiat

   2. **Automated Payment Processing**
      - PSP integration (Stripe, Revolut)
      - Auto-confirm payments
      - Auto-send crypto (—á–µ—Ä–µ–∑ Tatum)

   3. **White-Label Widget**
      - Embeddable iframe
      - Partner API
      - Partner dashboard

   4. **Advanced Analytics**
      - Revenue charts
      - User lifetime value
      - Conversion funnels
      - A/B testing

   5. **Mobile App** (Phase 3)
      - React Native
      - iOS + Android

   6. **P2P Trading** (Phase 3)
      - Client-to-client trades
      - Escrow service

   ---

   ## üìö Documentation

   ### Available Documentation

   - `README.md` - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - `PROJECT_SUMMARY.md` - –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ
   - `FINAL_STATUS.md` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
   - `CRM_FINAL_STATUS.md` - CRM —Å—Ç–∞—Ç—É—Å
   - `SECURITY.md` - –ø–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - `API_DOCUMENTATION.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
   - `DEPLOYMENT.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
   - `KYCAID_SETUP.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ KYCAID
   - `VERCEL_DEPLOYMENT_GUIDE.md` - –¥–µ–ø–ª–æ–π –Ω–∞ Vercel

   ### Code Documentation

   - TypeScript strict mode
   - JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - Inline comments –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
   - README –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ (–≥–¥–µ –Ω—É–∂–Ω–æ)

   ---

   ## üéä Conclusion

   **Apricode Exchange** - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è, production-ready –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã —Å:

   ‚úÖ **Comprehensive Security** - multi-layer security —Å MFA, RBAC, audit logging  
   ‚úÖ **Enterprise Features** - CRM —Å–∏—Å—Ç–µ–º–∞, IAM, compliance-ready  
   ‚úÖ **Scalable Architecture** - –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é  
   ‚úÖ **Production Ready** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã, –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  

   **–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

   ---

   **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 01 –Ω–æ—è–±—Ä—è 2025  
   **–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0

